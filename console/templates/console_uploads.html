{% extends "console-layout/layout.html" %}

{% block page_title %}Uploads{{data.name}} {% endblock  %}

{% block main_body %}
{% load static %}
{% load poll_extras %}

{% comment %} {{token}} {% endcomment %}
<script>
  var popup_check=false;
  var package_data;
</script>


<script src="/static/assets/js/poper.js"></script>
<script src="/static/assets/js/popup_confirm.js"></script>
<script src="/static/assets/js/fetch.js"></script>
{% if request.GET.sec == 'reels' %}
  <script src="/static/assets/js/reels_upload_popup_form.js"></script>
{% else %}
  <script src="/static/assets/js/upload_popup_form.js"></script>
{% endif %}

{% with sec=request.GET.sec %}

<div class="text-lg text-slate-900 border-b select-none w-full text-start p-2 flex justify-between">
  <span>Uploads</span>
  <button type="button" class="upload_{{sec}}_btn py-1 px-4 inline-flex items-center gap-x-2 text-xs font-semibold rounded-lg border bg-white text-gray-800 hover:bg-gray-200 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600 capitalize">Upload {{sec|customreplacespace:'_'}}</button>
</div>

{% comment %} <div class="w-full h-[50px] flex items-center justify-end"> {% endcomment %}

<div class="flex flex-col h-full bg-white w-full rounded-xl p-4 pb-0 mt-4">
  <div class="-m-1.5 overflow-x-auto">

    <div class="border-b-2 border-gray-200 dark:border-gray-700 shadow-md">
      <nav class="-mb-0.5 flex space-x-6">

        {% comment %} {{request.GET.get(sec)}} {% endcomment %}

        {% for r,v in request.GET.items %}
          {% if r == 'sec' %}

              {% with active='client_nav py-4 px-1 inline-flex items-center gap-2 border-b-2 border-blue-500 text-xs font-medium whitespace-nowrap text-blue-600 focus:outline-none focus:text-blue-800' inactive='client_nav py-4 px-1 inline-flex items-center gap-2 border-b-2 border-transparent text-xs whitespace-nowrap text-gray-500 hover:text-blue-600 focus:outline-none focus:text-blue-600' %}

                <a class="{% if v == 'pre_wedding' %}{{active}}{% else %}{{inactive}}{% endif %}" data-status='active' name='pre_wedding' href="#">
                  <img class="h-[20px] w-[20px]" src="/static/assets/images/icons/wedding_gray.png">
                  Pre Wedding
                </a>
                <a class="{% if v == 'wedding' %}{{active}}{% else %}{{inactive}}{% endif %}" data-status='inactive' name='wedding' href="#" aria-current="page">
                  <img class="h-[20px] w-[20px]" src="/static/assets/images/icons/pre-wedding_gray.png">
                  Wedding
                </a>
 
                <a class="{% if v == 'events' %}{{active}}{% else %}{{inactive}}{% endif %}" data-status='inactive' name='events' href="#">
                  <img class="h-[20px] w-[20px]" src="/static/assets/images/icons/events_gray.png">
                  Events
                </a>

                <a class="{% if v == 'reels' %}{{active}}{% else %}{{inactive}}{% endif %}" data-status='inactive' name='reels' href="#">
                  <img class="h-[20px] w-[20px]" src="/static/assets/images/icons/reels_gray.png">
                  Reels
                </a>
              {% endwith %}
        {% endif %}
      {% endfor %}
      </nav>
    </div>

    <div class="main_container p-1.5 min-w-full inline-block align-middle">
      <div>
        <div class="flex flex-col  rounded-xl">
            <div class="-m-1.5 overflow-x-auto">
              <div class="p-1.5 min-w-full inline-block align-middle">
                <div class="overflow-hidden border p-2 py-3">
                  <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 table table-zebra">
                    <thead>
                      <tr>
                        <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Title</th>
                        <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Description</th>
                        <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Thumbnail</th>
                        <th scope="col" class="px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase">Action</th>
                      </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                    
                    {% if pages != 'no data' %} {% for r in pages %}
                    
                      <tr>
                        <td class="px-6 py-1 whitespace-nowrap text-xs font-medium text-gray-800 dark:text-gray-200">{{ r.title }}</td>
                        <td class="px-6 py-1 whitespace-nowrap text-xs text-gray-800 dark:text-gray-200">{{ r.description|slice:":50" }} {% if r.description|length > 50 %}...{% endif %}</td>
                        <td class="px-6 py-1 whitespace-nowrap text-xs text-gray-800 dark:text-gray-200"> <a target="blank" href="/media/{% if sec == 'reels' %}{{ r.file }}{% else %}{{ r.cover_picture }}{% endif %}"> {% if sec == 'reels' %}<video paused class="w-9 h-10"><source src="/media/{{r.file}}"></video>{% else %}<img class="w-9 h-10"  src="/media/{{r.cover_picture}}">{% endif %}</a></td>
                        <td class="px-6 py-1 whitespace-nowrap text-end text-xs font-medium">
                            
                            {% if sec != 'reels' %}
                              <button type="button" data-id={{r.id}} class="edit py-1 px-1 w-12 flex justify-center items-center inline-flex items-center gap-x-2 text-xs font-semibold rounded-lg border border-transparent bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">Edit</button>
                            {% endif %}
                            
                            <button type="button" data-id={{r.id}} {% if sec == 'reels' %}data-file="/media/{{r.file}}"{% else %}data-cover-picture="/media/{{r.cover_picture}}"{% endif %} class="delete_{{sec}} py-1 px-1 w-12 flex justify-center items-center inline-flex items-center gap-x-2 text-xs font-semibold rounded-lg border border-transparent bg-red-500 text-white hover:bg-red-600 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">Delete</button>
                        </td>
                      </tr>
                      {% endfor %}
                    
                      {% else %}
                      <tr>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800 dark:text-gray-200">{{ pages }}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-gray-200">{{ pages }}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-gray-200">{{ pages }}</td>
                        {% comment %} <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-gray-200 flex"> </td> {% endcomment %}
                        <td class="px-6 py-4 whitespace-nowrap text-end text-sm font-medium">
                          <button type="button" class="inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent text-blue-600 hover:text-blue-800 disabled:opacity-50 disabled:pointer-events-none dark:text-blue-500 dark:hover:text-blue-400 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">{{pages}}</button>
                        </td>
                      </tr>
                    
                      {% endif %}
                    </tbody>
                  </table>
                
                
                  <script>
                      function validateUploadForm(){
    
                        let description = document.querySelector('.description');
                        let title = document.querySelector('.title');
                        const error_message = document.querySelector('.error_message');
                        
                        {% if sec == 'reels' %}
                          let file = document.querySelector('.reel_file');            
                        {% else %}
                          let cover_picture = document.querySelector('.cover_picture');
                          let yt_video = document.getElementById('yt_video');
                          let video_link = document.querySelector('.video_link');
                          let youtube_link = document.querySelector('.youtube_link');
                        {% endif %}
    
                        //let description = document.querySelector('.description');
                        //let title = document.querySelector('.title');
                        //const error_message = document.querySelector('.error_message');
                      
                        function success(el, message){
                            error_message.innerText = message
                            if (el != 0) {
                                el.classList.remove('outline')
                                el.classList.remove('outline-1')
                                el.classList.remove('outline-red-600')
                                el.classList.remove('outline-offset-0')
                            }
                        }
                        function failed(el, message){
                            error_message.innerText = message
                            if (el != 0) {
                                el.classList.add('outline')
                                el.classList.add('outline-1')
                                el.classList.add('outline-red-600')
                                el.classList.add('outline-offset-0')
                            }
                        }
    
                        
    
                        title.addEventListener('blur', ()=>{
                          console.log(title.value.length)
                          if (title.value.length < 1) {
                              failed(title, 'title should not be blank')
                          } else {
                              success(title, '')
                          }
                        })
                        description.addEventListener('blur', ()=>{
                            console.log(description.value.length)
                            if (description.value.length < 1) {
                                failed(description, 'description should not be blank')
                            } else {
                                success(description, '')
                            }
                        })
    
    
                        {% if sec == 'reels' %}
                        
                          file.addEventListener('change', ()=>{
                            if(file.files[0].type === "video/mp4"){
                                const error_message = document.querySelector('.error_message');
                                success(file, '')
                            } else {
                                failed(file, 'Only video/mp4 files can be uploaded')
                            }
                          })
    
                        {% else %}
                      
                          cover_picture.addEventListener('change', ()=>{
                            console.log(cover_picture.files[0].type.includes('image'))
                              if(cover_picture.files[0].type.includes("image")){
                                  const error_message = document.querySelector('.error_message');
                                  success(cover_picture, '')
                              } else {
                                  failed(cover_picture, 'Only image files can be uploaded')
                              }
                          })
                        
                          video_link.addEventListener('change', ()=>{
                            console.log(video_link.files[0].type.includes('video'))
                              if(video_link.files[0].type.includes("video")){
                                  const error_message = document.querySelector('.error_message');
                                  success(video_link, '')
                              } else {
                                  failed(video_link, 'Only video files can be uploaded')
                              }
                          })
                        
                          // title.addEventListener('blur', ()=>{
                          //     console.log(title.value.length)
                          //     if (title.value.length < 1) {
                          //         failed(title, 'title should not be blank')
                          //     } else {
                          //         success(title, '')
                          //     }
                          // })
                        // 
                          // description.addEventListener('blur', ()=>{
                          //     console.log(description.value.length)
                          //     if (description.value.length < 1) {
                          //         failed(description, 'description should not be blank')
                          //     } else {
                          //         success(description, '')
                          //     }
                          // })
                        
                          youtube_link.addEventListener('blur', ()=>{
                            console.log(youtube_link.value.length)
                            if (youtube_link.value.length < 1) {
                                failed(youtube_link, 'youtube_link should not be blank')
                            } else {
                                success(youtube_link, '')
                            }
                        })
    
    
                      {% endif %}
    
                      }
                    
    
                          const upload_{{sec}}_btn= document.querySelector('.upload_{{sec}}_btn');
                          upload_{{sec}}_btn.addEventListener('click', ()=>{
                              popupFun('{{sec|customreplacespace:"_"}}')
                              validateUploadForm()
                          
                              const upload_submit = document.querySelector('.upload_submit');
                              upload_submit.addEventListener('click', ()=>{
                                let description = document.querySelector('.description');
                                let title = document.querySelector('.title');
                                {% if sec == 'reels' %}
                                  let file = document.querySelector('.reel_file');            

                                  if(file.files[0].type === "video/mp4" && title.value.length > 0 && description.value.length > 0){
                                {% else %}
                                  let cover_picture = document.querySelector('.cover_picture');
                                  let yt_video = document.getElementById('yt_video');
                                  let video_link = document.querySelector('.video_link');
                                  let youtube_link = document.querySelector('.youtube_link');
                                  if(cover_picture.files[0].type.includes("image")  && title.value.length > 0 && description.value.length > 0 && (youtube_link.value.length > 0 || video_link.files[0].type.includes("video"))){
                                {% endif %}
                                          let formData = new FormData();
                                          formData.append('title', title.value)
                                          formData.append('description', description.value)
                                          
                                          {% if sec == 'reels' %}
                                            formData.append('file', file.files[0])                                      
                                          {% else %}
                                            formData.append('cover_picture', cover_picture.files[0])
                                            formData.append('is_youtube_video', yt_video.checked)
                                            if (yt_video.checked){
                                              formData.append('video_youtube_link', youtube_link.value)
                                            } else {
                                              formData.append('video_link', video_link.files[0])
                                            }
                                          {% endif %}
                                        
                                        
                                          // let token = localStorage.getItem('token')
                                          let token = getCookies()
                                          if (token){
                                              (async function rlUpl(){
                                                  console.log('asdfasdf')
                                                  let a = await fetch('{% if sec == "pre_wedding" %}{% url "upload_pre_wedding" %}{% elif sec == "wedding" %}{% url "upload_wedding" %}{% elif sec == "events" %}{% url "upload_events" %}{% elif sec == "reels" %}{% url "upload_reels" %}{% endif %}', {method: 'POST', headers:{ 'Authorization': 'Bearer '+ token.access}, body: formData})
                                                  a = await a.json()
                                                  if (a && a.status === 200){
                                                      // const popup = document.querySelector('.popup');
                                                      // popup.remove()
                                                      poperFunction(a.status, a.message, false);
    
                                                  } else {
                                                    poperFunction(a.status, a.message, false)
                                                  }
                                              }())
                                          }
                                      } else {
                                          failed(0, 'something went wrong, no issue at the server\'s end')
                                      }
                              })
                          })
                        
                            
                    const delete_{{sec}} = document.querySelectorAll('.delete_{{sec}}');
                    if (delete_{{sec}}.length > 0){
                      delete_{{sec}}.forEach(e=>{
                        e.addEventListener('click', (e)=>{
                          popupConfirmFun(e.target.getAttribute('data-id'), 'Delete {{sec|customreplacespace:"_"}}!', 'Are you sure you want to delete this {{sec|customreplacespace:"_"}}?' , {% if sec != "reels" %}e.target.getAttribute('data-file'){% else %}null{% endif %})
                        
                          const confirm = document.querySelector('.confirm');
                          confirm.addEventListener('click', async (e)=>{
                            let id = e.target.getAttribute('data-id')
                            // csrf = JSON.parse(localStorage.getItem('token'))
                            csrf = getCookies()
                            let a = await ftN(`/api/delete_{{sec}}/${id}`, 'DELETE', {'Content-Type': 'application/json', 'Authorization': 'Bearer '+csrf.access}, JSON.stringify({'data': 'no data'}))
                            if (a.status === 200){
                            
                              const popup = document.querySelector('.popup').remove();
                              poperFunction(a.status, a.message, true);
                            
                            } else {
                              poperFunction(a.status, a.message, false);
                            }
                          
                          })
                        
                        })
                      })
                    }
                  
                  {% if sec != 'reels' %}
                  
                    const edit = document.querySelectorAll('.edit');
                      edit.forEach(e=>{
                        e.addEventListener('click', async (f)=>{
                        // let token = JSON.parse(localStorage.getItem('token')).access
                        let token = getCookies().access
                        let url = '{% if sec == "pre_wedding" %}{% url "get_pre_wedding_indv" id=0 %}{% elif sec == "wedding" %}{% url "get_wedding_indv" id=0 %}{% elif sec == "events" %}{% url "get_events_indv" id=0 %}{% endif %}';
                        url = url.replaceAll(0,f.target.getAttribute('data-id'))
                        console.log(url)
                          let a = await ftN(url, 'GET', {'Content-Type': 'application/json', 'Authorization': 'Bearer '+token})
                          if (a.status === 200){
                          
                            const ftData = a.data
                            popupFun('{{sec|customreplacespace:"_"}}');
                            const title = document.querySelector('.title')
                            const description = document.querySelector('.description')
                            const yt_video = document.getElementById('yt_video')
                            const youtube_link = document.querySelector('.youtube_link')
                          
                            title.value = a.data.title;
                            description.value = a.data.description;
                            if (a.data.is_youtube_video){
                              yt_video.click();
                            } else{
                              const video_link_view = document.querySelector('.video_link_view');
                              video_link_view.innerHTML =`<video class="w-8 h-12"><source src="/static/${a.data.video_link}"></video> <span class="text-xs">or choose a new file</span>`
                            }
                          
                            youtube_link.value = a.data.video_youtube_link
                            const cover_picture_view = document.querySelector('.cover_picture_view');
                            cover_picture_view.innerHTML = `<img class="w-8 h-12" src="/media/${a.data.cover_picture}"> <span class="text-xs">or choose a new file</span>`
                          
                            const upload_submit = document.querySelector('.upload_submit');
                            upload_submit.classList.remove('upload_submit')
                            upload_submit.classList.add('upload_edit')
                            const upload_edit = document.querySelector('.upload_edit');
                            upload_edit.addEventListener('click', async ()=>{
                              let url =  '{% if sec == "pre_wedding" %}{% url "edit_pre_wedding_indv" id=0 %}{% elif sec == "wedding" %}{% url "edit_wedding_indv" id=0 %}{% elif sec == "events" %}{% url "edit_events_indv" id=0 %}{% elif sec == "reels" %}"edit_reels_indv" id=0{% endif %}'
                              url = url.replaceAll(0, f.target.getAttribute('data-id'))
                            
                              validateUploadForm()
                              let formData = new FormData()
                                formData.append('title', title.value)
                                formData.append('description',  description.value)
                                formData.append('is_youtube_video', yt_video.checked);
                              const cover_picture = document.querySelector('.cover_picture');
                              const video_link = document.querySelector('.video_link');
                              const video_youtube_link = document.querySelector('.youtube_link');
                            
                              if (cover_picture.files[0] && cover_picture.files[0].type.includes('image')){
                                formData.append('cover_picture', cover_picture.files[0])
                              }
                            
                                if (yt_video.checked){
                                    formData.append('video_youtube_link', youtube_link.value)
                                } else {
                                  if (video_link.files[0] && video_link.files[0].type.includes('video')){
                                    formData.append('video_link', video_link.files[0])
                                  }
                                }
                              
                              let a = await ftN(url, 'PUT', {'Authorization': 'Bearer '+token}, formData)
                              if (a.status == 200 ){
                                const popup = document.querySelector('.popup');
                                popup.remove()
                                poperFunction(a.status, a.message, true)
                              } else {
                                poperFunction(a.status, a.message, false)
                              }
                            
                            })
                          
                          } else {
                            poperFunction(a.status, a.message, false)
                          }
                      })
                    })
                    {% endif %}
                      let url = window.location.search
                      url = new URLSearchParams(url)
                      if (!url.get('sec')){
                        url.set('sec','pre_wedding')
                        window.location.href = window.location.pathname+'?'+url.toString()
                      }
      
      
                      const client_nav = document.querySelectorAll('.client_nav');
                      client_nav.forEach(e=>{
                        e.addEventListener('click', ()=>{
                          client_nav.forEach(f=>{
                            if (f.getAttribute('data-status') ==='active'){
                              f.classList.value = 'py-4 px-1 inline-flex items-center gap-2 border-b-2 border-transparent text-sm whitespace-nowrap text-gray-500 hover:text-blue-600 focus:outline-none focus:text-blue-600';  
                              f.setAttribute('data-status','inactive');
                            };
                          })
                          e.classList.value = 'py-4 px-1 inline-flex items-center gap-2 border-b-2 border-blue-500 text-sm font-medium whitespace-nowrap text-blue-600 focus:outline-none focus:text-blue-800';
                          e.setAttribute('data-status','active');
                          let url = window.location.search
                          url = new URLSearchParams(url);
                          console.log('url')
                          url.set('sec', e.name);
                          console.log(url.toString())
                          window.location.href = window.location.pathname+'?'+url.toString()
                        })
                      })
                  
                  
                  </script>
                
                
                  {% comment %} {% for p in pages  %} {% endcomment %}
                
                  {{pages.num_pages}}
                  {% comment %} {% endfor %} {% endcomment %}
                
                {% if pages != 'no data' %}
                  {% include 'console-layout/pagination.html' with pages=pages %}
                {% endif %} 
                
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
        
    </div>
  </div>
</div>



    {% comment %} <div class="main_container p-1.5 min-w-full inline-block align-middle"> {% endcomment %}
          {% comment %} {%for k,v in request.GET.items%} {% endcomment %}
            {% comment %} {% if k == 'sec' %} {% endcomment %}
              {% comment %} {% if v == 'pre_wedding' %} {% endcomment %}
                      {% comment %} <div class="w-full  h-[50px] flex items-center justify-end">
                        <div>
                            <button type="button" class="upload_pre_wedding_btn py-3 px-4 inline-flex items-center gap-x-2 text-xs font-semibold rounded-lg border bg-white text-gray-800 hover:bg-gray-200 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">Upload Pre Wedding</button>
                            
                              <script>
                                function validateUploadForm(){
                                  let cover_picture = document.querySelector('.cover_picture');
                                  let description = document.querySelector('.description');
                                  let title = document.querySelector('.title');
                                  let yt_video = document.getElementById('yt_video');
                                  let video_link = document.querySelector('.video_link');
                                  let youtube_link = document.querySelector('.youtube_link');
                                  const error_message = document.querySelector('.error_message');
                                
                                  function success(el, message){
                                      error_message.innerText = message
                                      if (el != 0) {
                                          el.classList.remove('outline')
                                          el.classList.remove('outline-4')
                                          el.classList.remove('outline-red-600')
                                          el.classList.remove('outline-offset-0')
                                      }
                                  }
                                  function failed(el, message){
                                      error_message.innerText = message
                                      if (el != 0) {
                                          el.classList.add('outline')
                                          el.classList.add('outline-4')
                                          el.classList.add('outline-red-600')
                                          el.classList.add('outline-offset-0')
                                      }
                                  }
                                
                                
                                  cover_picture.addEventListener('change', ()=>{
                                    console.log(cover_picture.files[0].type.includes('image'))
                                      if(cover_picture.files[0].type.includes("image")){
                                          const error_message = document.querySelector('.error_message');
                                          success(cover_picture, '')
                                      } else {
                                          failed(cover_picture, 'Only image files can be uploaded')
                                      }
                                  })
                                
                                  video_link.addEventListener('change', ()=>{
                                    console.log(video_link.files[0].type.includes('video'))
                                      if(video_link.files[0].type.includes("video")){
                                          const error_message = document.querySelector('.error_message');
                                          success(video_link, '')
                                      } else {
                                          failed(video_link, 'Only video files can be uploaded')
                                      }
                                  })
                                
                                  title.addEventListener('blur', ()=>{
                                      console.log(title.value.length)
                                      if (title.value.length < 1) {
                                          failed(title, 'title should not be blank')
                                      } else {
                                          success(title, '')
                                      }
                                  })
                                
                                  description.addEventListener('blur', ()=>{
                                      console.log(description.value.length)
                                      if (description.value.length < 1) {
                                          failed(description, 'description should not be blank')
                                      } else {
                                          success(description, '')
                                      }
                                  })
                                
                                  youtube_link.addEventListener('blur', ()=>{
                                    console.log(youtube_link.value.length)
                                    if (youtube_link.value.length < 1) {
                                        failed(youtube_link, 'youtube_link should not be blank')
                                    } else {
                                        success(youtube_link, '')
                                    }
                                })
                                }
                              
                              </script>
                              <script>
                                    const upload_pre_wedding_btn= document.querySelector('.upload_pre_wedding_btn');
                                    upload_pre_wedding_btn.addEventListener('click', ()=>{
                                        popupFun('Pre Wedding')
                                        validateUploadForm()
                                    
                                        const upload_submit = document.querySelector('.upload_submit');
                                        upload_submit.addEventListener('click', ()=>{
                                              if(cover_picture.files[0].type.includes("image")  && title.value.length > 0 && description.value.length > 0 && (youtube_link.value.length > 0 || video_link.files[0].type.includes("video"))){
                                                    let formData = new FormData();
                                                    formData.append('cover_picture', cover_picture.files[0])
                                                    formData.append('title', title.value)
                                                    formData.append('description', description.value)
                                                    formData.append('is_youtube_video', yt_video.checked)
                                                    if (yt_video.checked){
                                                      formData.append('video_youtube_link', youtube_link.value)
                                                    } else {
                                                      formData.append('video_link', video_link.files[0])
                                                    }
                                                  
                                                  
                                                    let token = getCookies()
                                                    if (token){
                                                        (async function rlUpl(){
                                                            console.log('asdfasdf')
                                                            let a = await fetch('{% url "upload_pre_wedding" %}', {method: 'POST', headers:{ 'Authorization': 'Bearer '+ token.access}, body: formData})
                                                            a = await a.json()
                                                            if (a && a.status === 200){
                                                                const popup = document.querySelector('.popup');
                                                                popup.remove()
                                                                poperFunction(a.status, a.message, true);

                                                            } else {
                                                              poperFunction(a.status, a.message, false)
                                                            }
                                                        }())
                                                    }
                                                } else {
                                                    failed(0, 'something went wrong, no issue at the server\'s end')
                                                }
                                        })
                                    })
                                  
                              </script>
                        </div>
                      </div>
                  
                      <div>
                        <div class="flex flex-col  rounded-xl p-4">
                            <div class="-m-1.5 overflow-x-auto">
                              <div class="p-1.5 min-w-full inline-block align-middle">
                                <div class="overflow-hidden">
                                  <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 table table-zebra">
                                    <thead>
                                      <tr>
                                        <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Title</th>
                                        <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Description</th>
                                        <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Thumbnail</th>
                                        <th scope="col" class="px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase">Action</th>
                                      </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                                    
                                    {% if pages != 'no data' %} {% for r in pages %}
                                    
                                      <tr>
                                        <td class="px-6 py-1 whitespace-nowrap text-xs font-medium text-gray-800 dark:text-gray-200">{{ r.title }}</td>
                                        <td class="px-6 py-1 whitespace-nowrap text-xs text-gray-800 dark:text-gray-200">{{ r.description|slice:":50" }} {% if r.description|length > 50 %}...{% endif %}</td>
                                        <td class="px-6 py-1 whitespace-nowrap text-xs text-gray-800 dark:text-gray-200"> <a target="blank" href="/static/{{ r.cover_picture }}"><img class="w-9 h-10"  src="/static/{{r.cover_picture}}"></a></td>
                                        <td class="px-6 py-1 whitespace-nowrap text-end text-xs font-medium">
                                            <button type="button" data-id={{r.id}} class="edit py-1 px-1 w-12 flex justify-center items-center inline-flex items-center gap-x-2 text-xs font-semibold rounded-lg border border-transparent bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">Edit</button>
                                            <button type="button" data-id={{r.id}} data-cover-picture="/static/{{r.cover_picture}}" class="delete_pre_wedding py-1 px-1 w-12 flex justify-center items-center inline-flex items-center gap-x-2 text-xs font-semibold rounded-lg border border-transparent bg-red-500 text-white hover:bg-red-600 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">Delete</button>
                                        </td>
                                      </tr>
                                      {% endfor %}
                                    
                                      {% else %}
                                      <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800 dark:text-gray-200">{{ pages }}</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-gray-200">{{ pages }}</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-gray-200">{{ pages }}</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-end text-sm font-medium">
                                          <button type="button" class="inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent text-blue-600 hover:text-blue-800 disabled:opacity-50 disabled:pointer-events-none dark:text-blue-500 dark:hover:text-blue-400 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">{{pages}}</button>
                                        </td>
                                      </tr>
                                    
                                      {% endif %}

                                    </tbody>
                                  </table>
                                  
                                
                                
                                  <script>
                                    
                                    const delete_pre_wedding = document.querySelectorAll('.delete_pre_wedding');
                                    if (delete_pre_wedding.length > 0){
                                      delete_pre_wedding.forEach(e=>{
                                        e.addEventListener('click', (e)=>{
                                          popupConfirmFun(e.target.getAttribute('data-id'), 'Delete Pre Wedding!', 'Are you sure you want to delete this pre wedding?' ,e.target.getAttribute('data-cover-picture'))
                                        
                                          const confirm = document.querySelector('.confirm');
                                          confirm.addEventListener('click', async (e)=>{
                                            let id = e.target.getAttribute('data-id')
                                            csrf = getCookies()

                                            let a = await ftN(`http://localhost:8000/api/delete_pre_wedding/${id}`, 'DELETE', {'Content-Type': 'application/json', 'Authorization': 'Bearer '+csrf.access}, JSON.stringify({'data': 'no data'}))
                                            if (a.status == 200){
                                            
                                              const popup = document.querySelector('.popup');
                                              popup.remove()
                                              poperFunction(a.status, a.message, true);
                                            
                                            } else {
                                              poperFunction(a.status, a.message, false);
                                            }
                                          
                                          })
                                        
                                        })
                                      })
                                    }
                                  
                                  
                                    const edit = document.querySelectorAll('.edit');
                                    edit.forEach(e=>{
                                      e.addEventListener('click', async (f)=>{
                                        let token = getCookies().access
                                        let url = '{% url "get_pre_wedding_indv" id=0 %}';
                                        url = url.replaceAll(0,f.target.getAttribute('data-id'))
                                        console.log(url)
                                          let a = await ftN(url, 'GET', {'Content-Type': 'application/json', 'Authorization': 'Bearer '+token})
                                          if (a.status === 200){
                                          
                                            const ftData = a.data
                                            popupFun('Pre Wedding');
                                            const title = document.querySelector('.title')
                                            const description = document.querySelector('.description')
                                            const yt_video = document.getElementById('yt_video')
                                            const youtube_link = document.querySelector('.youtube_link')
                                          
                                            title.value = a.data.title;
                                            description.value = a.data.description;
                                            if (a.data.is_youtube_video){
                                              yt_video.click();
                                            } else{
                                              const video_link_view = document.querySelector('.video_link_view');
                                              video_link_view.innerHTML =`<video class="w-8 h-12"><source src="/static/${a.data.video_link}"></video> <span>or choose a new file</span>`
                                            }
                                          
                                            youtube_link.value = a.data.video_youtube_link

                                            const cover_picture_view = document.querySelector('.cover_picture_view');
                                            cover_picture_view.innerHTML = `<img class="w-8 h-12" src="/static/${a.data.cover_picture}"> <span>or choose a new file</span>`
                                          
                                            const upload_submit = document.querySelector('.upload_submit');
                                            upload_submit.classList.remove('upload_submit')
                                            upload_submit.classList.add('upload_edit')

                                            const upload_edit = document.querySelector('.upload_edit');
                                            upload_edit.addEventListener('click', async ()=>{
                                              let url = '{% url "edit_pre_wedding_indv" id=0 %}'
                                              url = url.replaceAll(0, f.target.getAttribute('data-id'))
                                            
                                              validateUploadForm()
                                              let formData = new FormData()
                                                formData.append('title', title.value)
                                                formData.append('description',  description.value)
                                                formData.append('is_youtube_video', yt_video.checked);
                                              const cover_picture = document.querySelector('.cover_picture');
                                              const video_link = document.querySelector('.video_link');
                                              const video_youtube_link = document.querySelector('.youtube_link');
                                            
                                              if (cover_picture.files[0] && cover_picture.files[0].type.includes('image')){
                                                formData.append('cover_picture', cover_picture.files[0])
                                              }
                                            
                                                if (yt_video.checked){
                                                    formData.append('video_youtube_link', youtube_link.value)
                                                } else {
                                                  if (video_link.files[0] && video_link.files[0].type.includes('video')){
                                                    formData.append('video_link', video_link.files[0])
                                                  }
                                                }
                                              
                                              let a = await ftN(url, 'PUT', {'Authorization': 'Bearer '+token}, formData)
                                              if (a.status == 200 ){
                                                const popup = document.querySelector('.popup');
                                                popup.remove()
                                                poperFunction(a.status, a.message, true)
                                              } else {
                                                poperFunction(a.status, a.message, false)
                                              }
                                            
                                            })
                                          
                                          } else {
                                            poperFunction(a.status, a.message, false)
                                          }
                                      })
                                    })
                                  
                                  
                                  </script>
                                
                                  {{pages.num_pages}}

                                {% if pages != 'no data' %}
                                  {% include 'console-layout/pagination.html' with pages=pages %}
                                {% endif %} 
                                
                                </div>
                              </div>
                            </div>
                          </div>
                    </div> {% endcomment %}

              {% comment %} {% elif v == 'wedding' %} {% endcomment %}
                    {% comment %} <div class="w-full  h-[50px] flex items-center justify-end">
                        <div>
                            <button type="button" class="upload_wedding_btn py-3 px-4 inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-white text-gray-800 hover:bg-gray-200 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">
                                Upload Wedding
                              </button>
                            
                              <script>
                              
                                function validateUploadForm(){
                                  let cover_picture = document.querySelector('.cover_picture');
                                  let description = document.querySelector('.description');
                                  let title = document.querySelector('.title');
                                  let yt_video = document.getElementById('yt_video');
                                  let video_link = document.querySelector('.video_link');
                                  let youtube_link = document.querySelector('.youtube_link');
                                
                                  const error_message = document.querySelector('.error_message');
                                
                                  function success(el, message){
                                      error_message.innerText = message
                                      if (el != 0) {
                                          el.classList.remove('outline')
                                          el.classList.remove('outline-4')
                                          el.classList.remove('outline-red-600')
                                          el.classList.remove('outline-offset-0')
                                      }
                                  }
                                  function failed(el, message){
                                      error_message.innerText = message
                                      if (el != 0) {
                                          el.classList.add('outline')
                                          el.classList.add('outline-4')
                                          el.classList.add('outline-red-600')
                                          el.classList.add('outline-offset-0')
                                      }
                                  }
                                
                                
                                  cover_picture.addEventListener('change', ()=>{
                                    console.log(cover_picture.files[0].type.includes('image'))
                                      if(cover_picture.files[0].type.includes("image")){
                                          const error_message = document.querySelector('.error_message');
                                          success(cover_picture, '')
                                      } else {
                                          failed(cover_picture, 'Only image files can be uploaded')
                                      }
                                  })
                                
                                  video_link.addEventListener('change', ()=>{
                                    console.log(video_link.files[0].type.includes('video'))
                                      if(video_link.files[0].type.includes("video")){
                                          const error_message = document.querySelector('.error_message');
                                          success(video_link, '')
                                      } else {
                                          failed(video_link, 'Only video files can be uploaded')
                                      }
                                  })
                                
                                  title.addEventListener('blur', ()=>{
                                      console.log(title.value.length)
                                      if (title.value.length < 1) {
                                          failed(title, 'title should not be blank')
                                      } else {
                                          success(title, '')
                                      }
                                  })
                                  description.addEventListener('blur', ()=>{
                                      console.log(description.value.length)
                                      if (description.value.length < 1) {
                                          failed(description, 'description should not be blank')
                                      } else {
                                          success(description, '')
                                      }
                                  })
                                
                                  youtube_link.addEventListener('blur', ()=>{
                                    console.log(youtube_link.value.length)
                                    if (youtube_link.value.length < 1) {
                                        failed(youtube_link, 'youtube_link should not be blank')
                                    } else {
                                        success(youtube_link, '')
                                    }
                                })
                                }
                              
                              </script>
                            
                              <script>
                              
                                    const upload_wedding_btn= document.querySelector('.upload_wedding_btn');
                                    upload_wedding_btn.addEventListener('click', ()=>{
                                        popupFun('Wedding')
                                    
                                    
                                    
                                        const upload_submit = document.querySelector('.upload_submit');
                                        upload_submit.addEventListener('click', ()=>{
                                                if(cover_picture.files[0].type.includes("image") && title.value.length > 0 && description.value.length > 0  && (youtube_link.value.length > 0 || video_link.files[0].type.includes("video")) ){
                                                    let formData = new FormData();
                                                    formData.append('cover_picture', cover_picture.files[0]);
                                                    formData.append('title', title.value);
                                                    formData.append('description', description.value);
                                                    formData.append('is_youtube_video', yt_video.checked);
                                                    if (yt_video.checked){
                                                      formData.append('video_youtube_link', youtube_link.value);
                                                    } else {
                                                      formData.append('video_link', video_link.files[0]);
                                                    }
                                                  
                                                    let token = getCookies()
                                                    if (token){
                                                        (async function rlUpl(){
                                                            console.log('asdfasdf')
                                                            let a = await fetch('{% url "upload_wedding" %}', {method: 'POST', headers:{ 'Authorization': 'Bearer '+ token.access}, body: formData})
                                                            a = await a.json()
                                                            if (a && a.status === 200){
                                                              const popup = document.querySelector('.popup');
                                                              popup.remove()
                                                              poperFunction(a.status, a.message, true);                                             
                                                            } else {
                                                              poperFunction(a.status, a.message, false)
                                                            }
                                                        }())
                                                    }
                                                } else {
                                                    failed(0, 'something went wrong, no issue at the server\'s end')
                                                }
                                        })
                                    })
                                  
                                  
                              </script>
                        </div>
                    </div>
                    <div>
                      <div class="flex flex-col  bg-slate-100 rounded-xl p-4">
                          <div class="-m-1.5 overflow-x-auto">
                            <div class="p-1.5 min-w-full inline-block align-middle">
                              <div class="overflow-hidden">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                  <thead>
                                    <tr>
                                      <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Title</th>
                                      <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Description</th>
                                      <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Thumbnail</th>
                                      <th scope="col" class="px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase">Action</th>
                                    </tr>
                                  </thead>
                                  <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
              
              
                                  {% if pages != 'no data' %} {% for r in pages %}
              
              
                                    <tr>
                                      <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800 dark:text-gray-200">{{ r.title }}</td>
                                      <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-gray-200">{{ r.description|slice:":50" }} {% if r.description|length > 50 %}...{% endif %}</td>
                                      <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-gray-200"> <a target="blank" href="/static/{{ r.cover_picture }}"><img class="w-12 h-16"  src="/static/{{r.cover_picture}}"></a></td>
                                      <td class="px-6 py-4 whitespace-nowrap text-end text-sm font-medium">
                                        <button type="button" class="inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent text-blue-600 hover:text-blue-800 disabled:opacity-50 disabled:pointer-events-none dark:text-blue-500 dark:hover:text-blue-400 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">
                                          <button type="button" data-id={{r.id}} class="edit py-2 px-2 w-16 flex justify-center items-center inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">Edit</button>
                                          <button type="button" data-id={{r.id}} data-cover-picture="/static/{{r.cover_picture}}" class="delete_wedding py-2 px-2 w-16 flex justify-center items-center inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-red-500 text-white hover:bg-red-600 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">Delete</button>
                                        </button>
                                      </td>
                                    </tr>
                                    {% endfor %}
              
                                    {% else %}
                                    <tr>
                                      <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800 dark:text-gray-200">{{ pages }}</td>
                                      <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-gray-200">{{ pages }}</td>
                                      <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-gray-200">{{ pages }}</td>
                                      <td class="px-6 py-4 whitespace-nowrap text-end text-sm font-medium">
                                        <button type="button" class="inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent text-blue-600 hover:text-blue-800 disabled:opacity-50 disabled:pointer-events-none dark:text-blue-500 dark:hover:text-blue-400 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">{{pages}}</button>
                                      </td>
                                    </tr>
              
                                    {% endif %}
                                    
                                  </tbody>
                                </table>
            
              
              
                                <script>
                                  const delete_reels = document.querySelectorAll('.delete_wedding');
                                  if (delete_reels.length > 0){
                                    delete_reels.forEach(e=>{
                                      e.addEventListener('click', (e)=>{
                                        popupConfirmFun(e.target.getAttribute('data-id'), 'Delete Wedding!', 'Are you sure you want to delete this wedding?' ,e.target.getAttribute('data-cover-picture'))
              
                                        const confirm = document.querySelector('.confirm');
                                        confirm.addEventListener('click', async (e)=>{
                                          let id = e.target.getAttribute('data-id')
                                          csrf = getCookies()
                                          
                                          let a = await ftN(`http://localhost:8000/api/delete_wedding/${id}`, 'DELETE', {'Content-Type': 'application/json', 'Authorization': 'Bearer '+csrf.access}, JSON.stringify({'data': 'no data'}))
                                          if (a.status == 200){
                                            const popup = document.querySelector('.popup');
                                            popup.remove()
                                            poperFunction(a.status, a.message, true);
                                          } else {
                                            poperFunction(a.status, a.message, false);
              
                                          }
              
                                        })
              
                                      })
                                    })
                                  }
              
              
                                  const edit = document.querySelectorAll('.edit');
                                  edit.forEach(e=>{
                                    e.addEventListener('click', async (f)=>{
                                      let token = getCookies().access
                                      let url = '{% url "get_wedding_indv" id=0 %}';
                                      url = url.replaceAll(0,f.target.getAttribute('data-id'))
                                      console.log(url)
                                        let a = await ftN(url, 'GET', {'Content-Type': 'application/json', 'Authorization': 'Bearer '+token})
                                        if (a.status === 200){
              
                                          const ftData = a.data
                                          popupFun('Wedding');
                                          const title = document.querySelector('.title')
                                          const description = document.querySelector('.description')
                                          const yt_video = document.getElementById('yt_video')
                                          const youtube_link = document.querySelector('.youtube_link')
              
                                          title.value = a.data.title;
                                          description.value = a.data.description;
                                          if (a.data.is_youtube_video){
                                            yt_video.click();
                                          }  else{
                                            const video_link_view = document.querySelector('.video_link_view');
                                            video_link_view.innerHTML =`<video class="w-8 h-12"><source src="/static/${a.data.video_link}"></video> <span>or choose a new file</span>`
                                          }
                                          
                                          youtube_link.value = a.data.video_youtube_link
              
                                          const cover_picture_view = document.querySelector('.cover_picture_view');
                                          cover_picture_view.innerHTML = `<img class="w-8 h-12" src="/static/${a.data.cover_picture}"> <span>or choose a new file</span>`
              
                                          const upload_submit = document.querySelector('.upload_submit');
                                          upload_submit.classList.remove('upload_submit')
                                          upload_submit.classList.add('upload_edit')
                                          
                                          const upload_edit = document.querySelector('.upload_edit');
                                          upload_edit.addEventListener('click', async ()=>{
                                            let url = '{% url "edit_wedding_indv" id=0 %}'
                                            url = url.replaceAll(0, f.target.getAttribute('data-id'))
              
                                            validateUploadForm()
                                            let formData = new FormData()
                                              formData.append('title', title.value)
                                              formData.append('description',  description.value)
                                              formData.append('is_youtube_video', yt_video.checked);
              
                                            const cover_picture = document.querySelector('.cover_picture');
                                            const video_link = document.querySelector('.video_link');
                                            
                                            const video_youtube_link = document.querySelector('.youtube_link');
              
                                            if (cover_picture.files[0] && cover_picture.files[0].type.includes('image')){
                                              formData.append('cover_picture', cover_picture.files[0])
                                            }
              
                                              if (yt_video.checked){
                                                  formData.append('video_youtube_link', youtube_link.value)
                                              } else {
                                                if (video_link.files[0] && video_link.files[0].type.includes('video')){
                                                  formData.append('video_link', video_link.files[0])
                                                }
                                              }
              
                                            let a = await ftN(url, 'PUT', {'Authorization': 'Bearer '+token}, formData)
                                            if (a.status == 200 ){
                                              const popup = document.querySelector('.popup');
                                              popup.remove()
                                              poperFunction(a.status, a.message, true)
                                            } else {
                                              poperFunction(a.status, a.message, false)
                                            }
              
                                          })
              
              
                                        }
                                    })
                                  })
              
              
                                </script>
              
              
                                {{pages.num_pages}}
              
                                {% if pages != 'no data' %}
                                  {% include 'console-layout/pagination.html' with pages=pages %}
                                {% endif %} 
              
                              </div>
                            </div>
                          </div>
                        </div>
                    </div> 
                  {% endcomment %}

              {% comment %} {% elif v == 'events' %} {% endcomment %}
                {% comment %} <div class="w-full  h-[50px] flex items-center justify-end">
                  <div>
                      <button type="button" class="upload_reels_btn py-3 px-4 inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-white text-gray-800 hover:bg-gray-200 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">
                          Upload Events
                        </button>
          
                        <script>
          
                          function validateUploadForm(){
          
                            let cover_picture = document.querySelector('.cover_picture');
                            let description = document.querySelector('.description');
                            let title = document.querySelector('.title');
                            let yt_video = document.getElementById('yt_video');
                            let video_link = document.querySelector('.video_link');
                            let youtube_link = document.querySelector('.youtube_link');
          
          
                            const error_message = document.querySelector('.error_message');
          
                            function success(el, message){
                                error_message.innerText = message
                                if (el != 0) {
                                    el.classList.remove('outline')
                                    el.classList.remove('outline-4')
                                    el.classList.remove('outline-red-600')
                                    el.classList.remove('outline-offset-0')
                                }
                            }
                            function failed(el, message){
                                error_message.innerText = message
                                if (el != 0) {
                                    el.classList.add('outline')
                                    el.classList.add('outline-4')
                                    el.classList.add('outline-red-600')
                                    el.classList.add('outline-offset-0')
                                }
                            }
          
          
                            cover_picture.addEventListener('change', ()=>{
                              console.log(cover_picture.files[0].type.includes('image'))
                                if(cover_picture.files[0].type.includes("image")){
                                    const error_message = document.querySelector('.error_message');
                                    success(cover_picture, '')
                                } else {
                                    failed(cover_picture, 'Only image files can be uploaded')
                                }
                            })
          
                            video_link.addEventListener('change', ()=>{
                              console.log(video_link.files[0].type.includes('video'))
                                if(video_link.files[0].type.includes("video")){
                                    const error_message = document.querySelector('.error_message');
                                    success(video_link, '')
                                } else {
                                    failed(video_link, 'Only video files can be uploaded')
                                }
                            })
          
                            title.addEventListener('blur', ()=>{
                                console.log(title.value.length)
                                if (title.value.length < 1) {
                                    failed(title, 'title should not be blank')
                                } else {
                                    success(title, '')
                                }
                            })
                            description.addEventListener('blur', ()=>{
                                console.log(description.value.length)
                                if (description.value.length < 1) {
                                    failed(description, 'description should not be blank')
                                } else {
                                    success(description, '')
                                }
                            })
          
          
                            youtube_link.addEventListener('blur', ()=>{
                              console.log(youtube_link.value.length)
                              if (youtube_link.value.length < 1) {
                                  failed(youtube_link, 'youtube_link should not be blank')
                              } else {
                                  success(youtube_link, '')
                              }
                          })
          
                          }
          
                        </script>
          
                        <script>
                              const upload_reels_btn= document.querySelector('.upload_reels_btn');
                              upload_reels_btn.addEventListener('click', ()=>{
                                  popupFun('Events')
                                  validateUploadForm()
          
                                  const upload_submit = document.querySelector('.upload_submit');
                                  upload_submit.addEventListener('click', ()=>{
                                          if(cover_picture.files[0].type.includes("image") && title.value.length > 0 && description.value.length > 0  && (youtube_link.value.length > 0 || video_link.files[0].type.includes("video"))  ){
                                              let formData = new FormData();
                                              formData.append('cover_picture', cover_picture.files[0]);
                                              formData.append('title', title.value);
                                              formData.append('description', description.value);
                                              formData.append('is_youtube_video', yt_video.checked)
                                              if (yt_video.checked){
                                                formData.append('video_youtube_link', youtube_link.value);
                                              } else {
                                                formData.append('video_link', video_link.files[0]);
                                              }
          
                                              let token = getCookies()
                                              if (token){
                                                  (async function rlUpl(){
                                                      console.log('asdfasdf')
                                                      let a = await fetch('{% url "upload_events" %}', {method: 'POST', headers:{ 'Authorization': 'Bearer '+ token.access}, body: formData})
                                                      a = await a.json()
                                                      if (a && a.status === 200){
                                                          const popup = document.querySelector('.popup');
                                                          popup.remove()
                                                          poperFunction(a.status, a.message, true);  
                                                      } else {
                                                        poperFunction(a.status, a.message, false)
                                                      }
                                                  }())
                                              }
                                          } else {
                                              failed(0, 'something went wrong, no issue at the server\'s end')
                                          }
                                  })
                              })
          
          
                        </script>
                  </div>
                  </div>
          
              
                  <div>
                  <div class="flex flex-col  bg-slate-100 rounded-xl p-4">
                      <div class="-m-1.5 overflow-x-auto">
                        <div class="p-1.5 min-w-full inline-block align-middle">
                          <div class="overflow-hidden">
                            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                              <thead>
                                <tr>
                                  <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Title</th>
                                  <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Description</th>
                                  <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Thumbnail</th>
                                  <th scope="col" class="px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase">Action</th>
                                </tr>
                              </thead>
                              <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
          
          
          
          
                              {% if pages != 'no data' %} {% for r in pages %}
          
          
                                <tr>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800 dark:text-gray-200">{{ r.title }}</td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-gray-200">{{ r.description|slice:":50" }} {% if r.description|length > 50 %}...{% endif %}</td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-gray-200"> <a target="blank" href="/static/{{ r.cover_picture }}"><img class="w-12 h-16"  src="/static/{{r.cover_picture}}"></a></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-end text-sm font-medium">
                                    <button type="button" class="inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent text-blue-600 hover:text-blue-800 disabled:opacity-50 disabled:pointer-events-none dark:text-blue-500 dark:hover:text-blue-400 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">
                                      <button type="button" data-id={{r.id}} class="edit py-2 px-2 w-16 flex justify-center items-center inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">Edit</button>
                                      <button type="button" data-id={{r.id}} data-cover-picture="/static/{{r.cover_picture}}" class=" delete_events py-2 px-2 w-16 flex justify-center items-center inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-red-500 text-white hover:bg-red-600 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">Delete</button>
                                    </button>
                                  </td>
                                </tr>
                                {% endfor %}
          
                                {% else %}
                                <tr>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800 dark:text-gray-200">{{ pages }}</td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-gray-200">{{ pages }}</td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-gray-200">{{ pages }}</td>
                                  <td class="px-6 py-4 whitespace-nowrap text-end text-sm font-medium">
                                    <button type="button" class="inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent text-blue-600 hover:text-blue-800 disabled:opacity-50 disabled:pointer-events-none dark:text-blue-500 dark:hover:text-blue-400 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600">{{pages}}</button>
                                  </td>
                                </tr>
          
                                {% endif %}
                                
                              </tbody>
                            </table>
          
                            <script>
                              const delete_events = document.querySelectorAll('.delete_events');
                              if (delete_events.length > 0){
                                delete_events.forEach(e=>{
                                  e.addEventListener('click', (e)=>{
                                    popupConfirmFun(e.target.getAttribute('data-id'), 'Delete Event!', 'Are you sure you want to delete this Event?' ,e.target.getAttribute('data-cover-picture'))
          
                                    const confirm = document.querySelector('.confirm');
                                    confirm.addEventListener('click', async (e)=>{
                                      let id = e.target.getAttribute('data-id')
                                      csrf = getCookies()
                                      
                                      let a = await ftN(`http://localhost:8000/api/delete_events/${id}`, 'DELETE', {'Content-Type': 'application/json', 'Authorization': 'Bearer '+csrf.access}, JSON.stringify({'data': 'no data'}))
                                      if (a.status == 200){
                                        const popup = document.querySelector('.popup');
                                        popup.remove()
                                        poperFunction(a.status, a.message, true);
                                      } else {
                                        poperFunction(a.status, a.message, true);
                                      }
          
                                      const popup = document.querySelector('.popup')
                                      popup.remove()
                                    })
          
                                  })
                                })
                              }
          
          
          
                              const edit = document.querySelectorAll('.edit');
                              edit.forEach(e=>{
                                e.addEventListener('click', async (f)=>{
                                  let token = getCookies().access
                                  let url = '{% url "get_events_indv" id=0 %}';
                                  url = url.replaceAll(0,f.target.getAttribute('data-id'))
                                  console.log(url)
                                    let a = await ftN(url, 'GET', {'Content-Type': 'application/json', 'Authorization': 'Bearer '+token})
                                    if (a.status === 200){
          
                                      const ftData = a.data
                                      popupFun('Events');
                                      const title = document.querySelector('.title')
                                      const description = document.querySelector('.description')
                                      const yt_video = document.getElementById('yt_video')
                                      const youtube_link = document.querySelector('.youtube_link')
          
                                      title.value = a.data.title;
                                      description.value = a.data.description;
                                      if (a.data.is_youtube_video){
                                        yt_video.click();
                                      }  else{
                                        const video_link_view = document.querySelector('.video_link_view');
                                        video_link_view.innerHTML =`<video class="w-8 h-12"><source src="/static/${a.data.video_link}"></video> <span>or choose a new file</span>`
                                      }
                                      youtube_link.value = a.data.video_youtube_link
          
                                      const cover_picture_view = document.querySelector('.cover_picture_view');
                                      cover_picture_view.innerHTML = `<img class="w-8 h-12" src="/static/${a.data.cover_picture}"> <span>or choose a new file</span>`
          
                                      const upload_submit = document.querySelector('.upload_submit');
                                      upload_submit.classList.remove('upload_submit')
                                      upload_submit.classList.add('upload_edit')
                                      
                                      const upload_edit = document.querySelector('.upload_edit');
                                      upload_edit.addEventListener('click', async ()=>{
                                        let url = '{% url "edit_events_indv" id=0 %}'
                                        url = url.replaceAll(0, f.target.getAttribute('data-id'))
          
                                        validateUploadForm()
                                        let formData = new FormData()
                                          formData.append('title', title.value)
                                          formData.append('description',  description.value)
                                          formData.append('is_youtube_video', yt_video.checked);
                                        const cover_picture = document.querySelector('.cover_picture');
                                        const video_link = document.querySelector('.video_link');
                                        const video_youtube_link = document.querySelector('.youtube_link');
          
                                        if (cover_picture.files[0] && cover_picture.files[0].type.includes('image')){
                                          formData.append('cover_picture', cover_picture.files[0])
                                        }
          
                                          if (yt_video.checked){
                                              formData.append('video_youtube_link', youtube_link.value)
                                          } else {
                                            if (video_link.files[0] && video_link.files[0].type.includes('video')){
                                              formData.append('video_link', video_link.files[0])
                                            }
                                          }
          
                                        let a = await ftN(url, 'PUT', {'Authorization': 'Bearer '+token}, formData)
                                        if (a.status == 200 ){
                                          const popup = document.querySelector('.popup');
                                          popup.remove()
                                          poperFunction(a.status, a.message, true)
                                        } else {
                                          poperFunction(a.status, a.message, false)
                                        }
          
                                      })
          
          
                                    } else {
                                      poperFunction(a.status, a.message, false)
                                    }
                                })
                              })
          
          
                              
          
          
          
                            </script>
                            {{pages.num_pages}}
                              
                            {% if pages != 'no data' %}
                              {% include 'console-layout/pagination.html' with pages=pages %}
                            {% endif %} 
          
                          </div>
                        </div>
                      </div>
                    </div>
        
                  </div> 
                {% endcomment %}


              {% comment %} {% elif v == 'reels' %} {% endcomment %}
                              
        
        
                          {% comment %} {% for p in pages  %} {% endcomment %}
        
                          {% comment %} {{pages.num_pages}} {% endcomment %}
                            
                          {% comment %} {% endfor %} {% endcomment %}
        
                          {% comment %} {% if pages != 'no data' %} {% endcomment %}
                            {% comment %} {% include 'console-layout/pagination.html' with pages=pages %} {% endcomment %}
                          {% comment %} {% endif %}  {% endcomment %}
        
                        {% comment %} </div> {% endcomment %}
                      {% comment %} </div> {% endcomment %}
                    {% comment %} </div> {% endcomment %}
                  {% comment %} </div> {% endcomment %}
                {% comment %} </div> {% endcomment %}


              {% comment %} {% endif %} {% endcomment %}
            {% comment %} {% endif %} {% endcomment %}
          {% comment %} {% endfor %} {% endcomment %}



  {% comment %} <div>
    <div class="flex flex-col  bg-slate-100 rounded-xl p-4 mt-4">
      <div class="-m-1.5 overflow-x-auto">
        <div class="p-1.5 min-w-full inline-block align-middle">
          <div class="w-full h-auto overflow-hidden p-2">
            <div class='w-full h-auto bg-slate-400 flex justify-between items-center flex-wrap'>
              {% for key, value in data.items %}
              <span class="w-2/4 h-12 min-w-[350px] p-1 flex justify-start items-center flex-wrap"><span class="w-2/4 h-full flex items-center capitalize">{{ key }}</span><input class="rounded-xl w-2/4 h-full px-2" type='text' value="{{value}}" placeholder="name"></span>
              {% endfor %}
              
          </div>
        </div>
      </div>
  </div> {% endcomment %}



{% comment %} </div> {% endcomment %}





{% endwith %}
  
  
{% endblock  %}
  
  